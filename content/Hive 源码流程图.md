网上有一张 Hive Cli 源码流程图

[[hivecli流程图.png]]


这张图有一定的参考价值,但是要注意这是一张使用 Hive Cli  查询的执行图,也就是说 Driver 是运行在本地 cli 命令行中的. 跟使用 beeline 连接 hiveserver2 查询的流程是不一样的,省去了较为复杂的 thrift rpc 调用的交互过程.

但中间的 driver 的处理逻辑是共用的,只是说首尾不一样.一个是本地执行,一个是远程调用.远程调用涉及到网络传输,并发,权限控制等诸多问题,所以处理过程相对来说会更加复杂一点.


对于 beeline 和 hs2 完整的流程,可以通过分别抓取进程火焰图来对照分析






